# frozen_string_literal: true

# SolidQueue recurring jobs configuration
# Schedule format: "minute hour day month weekday" (cron-like)
# IST timezone (UTC+5:30) - adjust times accordingly
# Examples:
#   periodic_cleanup:
#     class: CleanSoftDeletedRecordsJob
#     queue: background
#     args: [ 1000, { batch_size: 500 } ]
#     schedule: every hour
#   periodic_cleanup_with_command:
#     command: "SoftDeletedRecord.due.delete_all"
#     priority: 2
#     schedule: at 5am every day

production:
  # Daily candle ingestion - 07:30 IST daily
  daily_candle_ingestion:
    class: Candles::DailyIngestorJob
    schedule: at 7:30am every day
    queue: default
    priority: 0

  # Weekly candle ingestion - 07:30 IST Monday
  weekly_candle_ingestion:
    class: Candles::WeeklyIngestorJob
    schedule: at 7:30am on Monday
    queue: default
    priority: 0

  # Swing screener - 07:40 IST weekdays (Monday-Friday)
  swing_screener:
    class: Screeners::SwingScreenerJob
    schedule: at 7:40am on weekdays
    queue: default
    priority: 0

  # Monitor job - Every 30 minutes during market hours (9:00 AM - 3:30 PM IST, weekdays)
  monitor_job:
    class: MonitorJob
    schedule: every 30 minutes from 9:00am to 3:30pm on weekdays
    queue: default
    priority: 1

  # Clean finished SolidQueue jobs - Every hour at minute 12
  clear_solid_queue_finished_jobs:
    command: "SolidQueue::Job.clear_finished_in_batches(sleep_between_batches: 0.3)"
    schedule: every hour at minute 12
    priority: 2

  # Optional: Intraday fetcher (commented out - on-demand only)
  # intraday_fetcher:
  #   class: Candles::IntradayFetcherJob
  #   schedule: at 7:45am on weekdays
  #   queue: default
  #   priority: 0

  # Optional: Swing entry monitor (commented out - for live trading)
  # swing_entry_monitor:
  #   class: Strategies::SwingEntryMonitorJob
  #   schedule: every 30 minutes from 9:00am to 3:30pm on weekdays
  #   queue: default
  #   priority: 1

  # Optional: Swing exit monitor (commented out - for live trading)
  # swing_exit_monitor:
  #   class: Strategies::SwingExitMonitorJob
  #   schedule: every 30 minutes from 9:00am to 3:30pm on weekdays
  #   queue: default
  #   priority: 1

development:
  # Same as production for development testing
  daily_candle_ingestion:
    class: Candles::DailyIngestorJob
    schedule: at 7:30am every day
    queue: default
    priority: 0

  weekly_candle_ingestion:
    class: Candles::WeeklyIngestorJob
    schedule: at 7:30am on Monday
    queue: default
    priority: 0

  swing_screener:
    class: Screeners::SwingScreenerJob
    schedule: at 7:40am on weekdays
    queue: default
    priority: 0

  monitor_job:
    class: MonitorJob
    schedule: every 30 minutes from 9:00am to 3:30pm on weekdays
    queue: default
    priority: 1

  clear_solid_queue_finished_jobs:
    command: "SolidQueue::Job.clear_finished_in_batches(sleep_between_batches: 0.3)"
    schedule: every hour at minute 12
    priority: 2
